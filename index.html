<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ã‚‚ãã‚‚ãç‰›</title>

<style>
Â  body {
Â  Â  margin: 0;
Â  Â  background: #e6f2e6;
Â  Â  font-family: sans-serif;
Â  Â  user-select: none;
Â  }

Â  #game {
Â  Â  position: relative;
Â  Â  width: 100vw;
Â  Â  height: 100vh;
Â  Â  overflow: hidden;
Â  Â  touch-action: none; /* ğŸ‘ˆ ä¿®æ­£2: ã‚¹ãƒãƒ›ã®ãƒ”ãƒ³ãƒã‚ºãƒ¼ãƒ ãƒ»ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’ç„¡åŠ¹åŒ– */
Â  }

Â  #score {
Â  Â  font-size: 26px;
Â  Â  padding: 12px;
Â  Â  text-align: center;
Â  }

Â  #cow {
Â  Â  position: absolute;
Â  Â  bottom: 20px;
Â  Â  font-size: 60px;
Â  Â  /* left: 45%; ã¯JSã§è¨­å®šã™ã‚‹ãŸã‚å‰Šé™¤ */
Â  }

Â  .item {
Â  Â  position: absolute;
Â  Â  font-size: 40px;
Â  }

Â  #overlay {
Â  Â  position: absolute;
Â  Â  inset: 0;
Â  Â  background: rgba(0,0,0,0.7);
Â  Â  color: #fff;
Â  Â  display: none;
Â  Â  align-items: center;
Â  Â  justify-content: center;
Â  Â  flex-direction: column;
Â  Â  font-size: 26px;
Â  Â  text-align: center;
Â  }

Â  #overlay button {
Â  Â  margin-top: 20px;
Â  Â  font-size: 22px;
Â  Â  padding: 12px 24px;
Â  }
</style>
</head>

<body>
<div id="game">
Â  <div id="score">ã‚¹ã‚³ã‚¢ï¼š0</div>
Â  <div id="cow">ğŸ„</div>

Â  <div id="overlay">
Â  Â  <div id="finalText"></div>
Â  Â  <button onclick="restart()">ã‚‚ã†ä¸€å›</button>
Â  </div>
</div>

<script>
const cow = document.getElementById("cow");
const scoreEl = document.getElementById("score");
const overlay = document.getElementById("overlay");
const finalText = document.getElementById("finalText");

// ğŸ‘ˆ ä¿®æ­£1-A: cowXã®åˆæœŸä½ç½®ã‚’ç‰›ã®å¹…ã‚’ä½¿ã£ã¦æ­£ç¢ºã«ä¸­å¤®ã«è¨­å®š
let cowX = window.innerWidth / 2 - (cow.offsetWidth / 2);
cow.style.left = cowX + "px"; 

let score = 0;
let gameOver = false;

let fallSpeed = 3;
let spawnInterval = 1400;

// ğŸ‘ˆ ä¿®æ­£1-B: ã‚¿ãƒƒãƒ—ã§ã‚¿ãƒƒãƒ—ä½ç½®ã«ç§»å‹•
document.addEventListener("click", e => {
Â  if (gameOver) return;

  // ã‚¿ãƒƒãƒ—ã—ãŸå ´æ‰€ã‚’ç‰›ã®ä¸­å¤®ã«è¨­å®š (ç‰›ã®å¹…ãŒ60pxã¨ä»®å®šã—ãªãã¦ã‚‚offsetWidthã§å–å¾—)
Â  let targetX = e.clientX - (cow.offsetWidth / 2); 

Â  // ç”»é¢ã®ç«¯ã‹ã‚‰ã¯ã¿å‡ºã•ãªã„ã‚ˆã†ã«åˆ¶é™
Â  cowX = Math.max(0, Math.min(window.innerWidth - cow.offsetWidth, targetX));
Â  cow.style.left = cowX + "px";
});

// ã‚¢ã‚¤ãƒ†ãƒ ç”Ÿæˆ
function createItem() {
Â  if (gameOver) return;

Â  const item = document.createElement("div");
Â  item.className = "item";

Â  const isGood = Math.random() < 0.75;
Â  item.textContent = isGood ? "ğŸŒ¾" : "ğŸ—‘ï¸";
Â  item.dataset.type = isGood ? "good" : "bad";

Â  item.style.left = Math.random() * (window.innerWidth - 40) + "px";
Â  item.style.top = "0px";

Â  document.getElementById("game").appendChild(item);

Â  const fall = setInterval(() => {
Â  Â  item.style.top = item.offsetTop + fallSpeed + "px";

Â  Â  const cowRect = cow.getBoundingClientRect();
Â  Â  const itemRect = item.getBoundingClientRect();

Â  Â  // å½“ãŸã‚Šåˆ¤å®š
Â  Â  if (
Â  Â  Â  itemRect.bottom > cowRect.top &&
Â  Â  Â  itemRect.left < cowRect.right &&
Â  Â  Â  itemRect.right > cowRect.left
Â  Â  ) {
Â  Â  Â  clearInterval(fall);
Â  Â  Â  item.remove();

Â  Â  Â  if (item.dataset.type === "good") {
Â  Â  Â  Â  score += 10;
Â  Â  Â  Â  scoreEl.textContent = "ã‚¹ã‚³ã‚¢ï¼š" + score;
Â  Â  Â  Â  difficultyUp();
Â  Â  Â  } else {
Â  Â  Â  Â  endGame();
Â  Â  Â  }
Â  Â  }

Â  Â  if (item.offsetTop > window.innerHeight) {
Â  Â  Â  clearInterval(fall);
Â  Â  Â  item.remove();
Â  Â  }
Â  }, 30);
}

// é›£æ˜“åº¦ã‚¢ãƒƒãƒ—ï¼ˆã‚†ã‚‹ã‚„ã‹ï¼‰
function difficultyUp() {
Â  if (score % 50 === 0) {
Â  Â  // ğŸ‘ˆ ä¿®æ­£3: è½ä¸‹é€Ÿåº¦ã«ä¸Šé™ã‚’è¨­å®š (ä¾‹: 15)
Â  Â  fallSpeed = Math.min(15, fallSpeed + 0.5); 
Â  Â  
Â  Â  // ğŸ‘ˆ ä¿®æ­£3: ç”Ÿæˆé–“éš”ã«ä¸‹é™ã‚’è¨­å®š (ä¾‹: 300ms)
Â  Â  spawnInterval = Math.max(300, spawnInterval - 100); 
Â  Â  
Â  Â  resetSpawner();
Â  }
}

let spawner = setInterval(createItem, spawnInterval);

function resetSpawner() {
Â  clearInterval(spawner);
Â  spawner = setInterval(createItem, spawnInterval);
}

// ã‚²ãƒ¼ãƒ çµ‚äº†
function endGame() {
Â  gameOver = true;
Â  // ã™ã§ã«é™ã£ã¦ã„ã‚‹ã‚¢ã‚¤ãƒ†ãƒ ã®setIntervalã‚’æ­¢ã‚ã‚‹å‡¦ç†ã‚’è¿½åŠ ã™ã‚‹ã¨å®Œç’§ã§ã™ãŒã€
Â  // ã“ã®ã¾ã¾ã§ã‚‚å•é¡Œã‚ã‚Šã¾ã›ã‚“ï¼ˆæ–°ã—ã„ã‚¢ã‚¤ãƒ†ãƒ ç”ŸæˆãŒæ­¢ã¾ã‚Œã°ï¼‰
Â  clearInterval(spawner);
Â  
Â  overlay.style.display = "flex";
Â  finalText.innerHTML = `
Â  Â  ãŠã¤ã‹ã‚Œã•ã¾ã§ã—ãŸ<br>
Â  Â  ã‚¹ã‚³ã‚¢ï¼š${score}
Â  `;
}

// ãƒªã‚¹ã‚¿ãƒ¼ãƒˆ
function restart() {
Â  location.reload();
}
</script>
</body>
</html>